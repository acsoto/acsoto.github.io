<!DOCTYPE html>
<html lang="zh-cn">
    <head><meta charset='utf-8'>
<meta name='viewport' content='width=device-width, initial-scale=1'><meta name='description' content='编译原理 理论 考前再浏览一下目录 文法和语言 符号、符号串 文法形式定义 推导、规约 语言 递归 语法树、二义性 实用限制 词法分析 正则文法机状态图 有穷自动机 语'><title>编译原理-理论部分</title>

<link rel='canonical' href='http://atksoto.com/p/buaa-compiler-theory/'>

<link rel="stylesheet" href="/scss/style.min.css"><meta property='og:title' content='编译原理-理论部分'>
<meta property='og:description' content='编译原理 理论 考前再浏览一下目录 文法和语言 符号、符号串 文法形式定义 推导、规约 语言 递归 语法树、二义性 实用限制 词法分析 正则文法机状态图 有穷自动机 语'>
<meta property='og:url' content='http://atksoto.com/p/buaa-compiler-theory/'>
<meta property='og:site_name' content='SOTO-BLOG'>
<meta property='og:type' content='article'><meta property='article:section' content='Post' /><meta property='article:tag' content='编译' /><meta property='article:published_time' content='2021-12-15T10:11:00&#43;08:00'/><meta property='article:modified_time' content='2021-12-15T10:11:00&#43;08:00'/><meta property='og:image' content='https://pic.mcatk.com/soto/202112202258896.png' />
<meta name="twitter:site" content="@TongFan_">
    <meta name="twitter:creator" content="@TongFan_"><meta name="twitter:title" content="编译原理-理论部分">
<meta name="twitter:description" content="编译原理 理论 考前再浏览一下目录 文法和语言 符号、符号串 文法形式定义 推导、规约 语言 递归 语法树、二义性 实用限制 词法分析 正则文法机状态图 有穷自动机 语"><meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:image" content='https://pic.mcatk.com/soto/202112202258896.png' />
    <link rel="shortcut icon" href="https://pic.mcatk.com/soto/202112220131460.JPG" />

    </head>
    <body class="
    article-page has-toc
">
    <script>
        (function() {
            const colorSchemeKey = 'StackColorScheme';
            if(!localStorage.getItem(colorSchemeKey)){
                localStorage.setItem(colorSchemeKey, "auto");
            }
        })();
    </script><script>
    (function() {
        const colorSchemeKey = 'StackColorScheme';
        const colorSchemeItem = localStorage.getItem(colorSchemeKey);
        const supportDarkMode = window.matchMedia('(prefers-color-scheme: dark)').matches === true;

        if (colorSchemeItem == 'dark' || colorSchemeItem === 'auto' && supportDarkMode) {
            

            document.documentElement.dataset.scheme = 'dark';
        } else {
            document.documentElement.dataset.scheme = 'light';
        }
    })();
</script>
<div class="container main-container flex 
    
        extended
    
">
    
        <div id="article-toolbar">
            <a href="/" class="back-home">
                <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-chevron-left" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <polyline points="15 6 9 12 15 18" />
</svg>



                <span>返回</span>
            </a>
        </div>
    
<main class="main full-width">
    <article class="has-image main-article">
    <header class="article-header">
        <div class="article-image">
            <a href="/p/buaa-compiler-theory/">
                
                    <img src="https://pic.mcatk.com/soto/202112202258896.png" loading="lazy" alt="Featured image of post 编译原理-理论部分" />
                
            </a>
        </div>
    

    <div class="article-details">
    
    <header class="article-category">
        
            <a href="/categories/coding/" >
                Coding
            </a>
        
    </header>
    

    <h2 class="article-title">
        <a href="/p/buaa-compiler-theory/">编译原理-理论部分</a>
    </h2>

    

    
    <footer class="article-time">
        
            <div>
                <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-calendar-time" width="56" height="56" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <path d="M11.795 21h-6.795a2 2 0 0 1 -2 -2v-12a2 2 0 0 1 2 -2h12a2 2 0 0 1 2 2v4" />
  <circle cx="18" cy="18" r="4" />
  <path d="M15 3v4" />
  <path d="M7 3v4" />
  <path d="M3 11h16" />
  <path d="M18 16.496v1.504l1 1" />
</svg>
                <time class="article-time--published">Dec 15, 2021</time>
            </div>
        

        
    </footer>
    
</div>
</header>

    <section class="article-content">
    <h1 id="编译原理-理论">编译原理 理论</h1>
<p>考前再浏览一下目录</p>
<ul>
<li>文法和语言
<ul>
<li>符号、符号串</li>
<li>文法形式定义
<ul>
<li>推导、规约</li>
<li>语言</li>
<li>递归</li>
</ul>
</li>
<li>语法树、二义性</li>
<li>实用限制</li>
</ul>
</li>
<li>词法分析
<ul>
<li>正则文法机状态图</li>
<li>有穷自动机</li>
</ul>
</li>
<li>语法分析
<ul>
<li>自顶向下
<ul>
<li>LL(1)分析</li>
</ul>
</li>
<li>自底向上
<ul>
<li>算符优先分析</li>
<li>LR语法分析</li>
</ul>
</li>
</ul>
</li>
<li>语法制导翻译
<ul>
<li>翻译文法</li>
</ul>
</li>
<li>符号表</li>
<li>运行时存储
<ul>
<li>静态分配</li>
<li>动态分配</li>
<li>内存回收</li>
</ul>
</li>
<li>中间代码
<ul>
<li>波兰表示、N元表示</li>
</ul>
</li>
<li>错误处理</li>
<li>语义分析</li>
<li>代码优化
<ul>
<li>基本块和流图</li>
<li>基本块优化</li>
<li>全局优化</li>
</ul>
</li>
<li>目标代码生成
<ul>
<li>寄存器分配</li>
</ul>
</li>
</ul>
<hr>
<h2 id="编译过程">编译过程</h2>
<p>典型的编译程序具有7个逻辑部分</p>
<ol>
<li>词法分析</li>
<li>语法分析</li>
<li>语义分析、生成中间代码</li>
<li>代码优化</li>
<li>生成目标程序</li>
</ol>
<ul>
<li>符号表管理</li>
<li>出错处理</li>
</ul>
<h2 id="文法">文法</h2>
<h3 id="推导">推导</h3>
<p>文法  $G=(V_n，V_t，P，Z)$</p>
<p>巴科斯范式<strong>BNF</strong>规定是推导规则(产生式)的集合，写为：</p>
<p>&lt;符号&gt; ::= &lt;使用符号的表达式&gt;</p>
<p>如 E-&gt;E+T|T 的扩充BNF表示为 E-&gt;T{+T}</p>
<ul>
<li>$V_n: 非终结符号集$</li>
<li>$V_t:终结符号集$</li>
<li>$P:产生式或规则的集合$</li>
<li>$Z:开始符号(识别符号) Z \in V_n$</li>
</ul>
<h3 id="句型-短语-句柄">句型 短语 句柄</h3>
<p>句型是文法的某个推导</p>
<ul>
<li><strong>短语</strong>是前面句型中的某个非终结符所能推出的符号串。</li>
<li>任何句型本身一定是相对于识别符号Z的短语。</li>
<li>任一句型的最左简单短语称为该句型的<strong>句柄</strong>。</li>
<li>素短语，是指至少含有一个终结符的短语，并且除自身外，不包含更小的素短语。</li>
</ul>
<p>从树的角度，直观的理解</p>
<ul>
<li><strong>短语</strong>：一个句型的语法树中任一子树叶结点所组成的符号串都是该句型的短语</li>
<li><strong>简单短语</strong>：如果子树中不再包含其他的子树，即A只能推导出b，而b不能再推出其他的式子，则b为此句型的简单短语</li>
<li><strong>句柄</strong>：最左直接短语为该句型的句柄</li>
</ul>
<h4 id="一个例子">一个例子</h4>
<p>文法G[E]为：</p>
<p>E ::= RP|P</p>
<p>P ::= (E)|i</p>
<p>R ::= RP+ | RP* | P+ | P*</p>
<p>上下文无关文法</p>
<p>句型 (P+(i)) 的规范推导序列：</p>
<p>E =&gt;P=&gt;(E)=&gt;(RP)=&gt;(R(E))=&gt;(R(P)=&gt;(R(i))=&gt;(P+(i))</p>
<p>语法树</p>
<p>[[语法推导树 2021-12-16 18.40.11.excalidraw]]
<figure 
	>
	<a href="https://pic.mcatk.com/soto/202112161909572.svg" >
		<img src="https://pic.mcatk.com/soto/202112161909572.svg"
			
			
			
			loading="lazy"
			alt="语法推导树">
	</a>
	
	<figcaption>语法推导树</figcaption>
	
</figure></p>
<p>短语：(P+(i))，P+(i)，P+，(i)，i</p>
<p>简单短语P＋, i</p>
<p>句柄P+</p>
<h3 id="chomsky文法体系">Chomsky文法体系</h3>
<table>
<thead>
<tr>
<th>文法</th>
<th>语言</th>
<th>自动机</th>
<th>产生式规则</th>
</tr>
</thead>
<tbody>
<tr>
<td>0型</td>
<td>递归可枚举语言</td>
<td>图灵机</td>
<td>α -&gt; β（无限制）</td>
</tr>
<tr>
<td>1型</td>
<td>上下文相关语言</td>
<td>线性有界非确定图灵机</td>
<td>α_A_β -&gt; αγβ</td>
</tr>
<tr>
<td>2型</td>
<td>上下文无关语言</td>
<td>非确定下推自动机</td>
<td>A -&gt; γ</td>
</tr>
<tr>
<td>3型</td>
<td>正则语言</td>
<td>有限状态自动机</td>
<td>A -&gt; aB  A -&gt; a</td>
</tr>
</tbody>
</table>
<h3 id="二义性">二义性</h3>
<ul>
<li>不同的语法树</li>
<li>不同的<strong>规范</strong>推导</li>
<li>某规范句型句柄不唯一</li>
</ul>
<h3 id="文法的实用限制">文法的实用限制</h3>
<ul>
<li>有害规则</li>
<li>多余规则
<ul>
<li>不可达符号（始终用不到）</li>
<li>不活动符号（推不出任何终结符号）</li>
</ul>
</li>
</ul>
<h2 id="词法">词法</h2>
<h3 id="正则文法和状态图">正则文法和状态图</h3>
<ul>
<li>右线性文法
<ul>
<li>形如：  A → aB  A → a</li>
<li>状态图：自上而下推导，需要一个终结状态，用终结符作为条件从左部非终结符指向右部非终结符</li>
</ul>
</li>
<li>左线性文法
<ul>
<li>形如：  A → Ba  A → a</li>
<li>状态图: 自下而上规约，需要一个初始状态，然后从终态开始，箭头倒置，用终结符作为条件从右部非终结符指向左部非终结符
转换：用一个线性文法作状态图，再读出为另一个线性文法</li>
</ul>
</li>
</ul>
<p>例：</p>
<p><figure 
	>
	<a href="https://pic.mcatk.com/soto/202112210045742.png" >
		<img src="https://pic.mcatk.com/soto/202112210045742.png"
			
			
			
			loading="lazy"
			>
	</a>
	
</figure></p>
<p>右线性正则文法：</p>
<p>S-&gt;bU|aV
U-&gt;bZ
V-&gt;bZ
Z-&gt;aV
Z-&gt;$\epsilon$</p>
<p>左线性正则文法</p>
<p>Z-&gt;Ub|Vb|$\epsilon$
V-&gt;Za|a
U-&gt;b
V-&gt;a</p>
<h3 id="正则表达式与有穷自动机">正则表达式与有穷自动机</h3>
<h4 id="dfa">DFA</h4>
<p>确定的有穷自动机</p>
<p><figure 
	>
	<a href="https://pic.mcatk.com/soto/202112170033317.png" >
		<img src="https://pic.mcatk.com/soto/202112170033317.png"
			
			
			
			loading="lazy"
			alt="确定的有穷自动机">
	</a>
	
	<figcaption>确定的有穷自动机</figcaption>
	
</figure></p>
<h4 id="nfa">NFA</h4>
<p>不确定的有穷自动机</p>
<p>$$
L(M') = {a^mb|m\geq1}\cup{ac^n|n\geq 1}\cup{ \epsilon }
$$</p>
<p><figure 
	>
	<a href="https://pic.mcatk.com/soto/202112170033688.png" >
		<img src="https://pic.mcatk.com/soto/202112170033688.png"
			
			
			
			loading="lazy"
			alt="不确定的有穷自动机">
	</a>
	
	<figcaption>不确定的有穷自动机</figcaption>
	
</figure></p>
<h4 id="nfa-dfa-最小dfa">NFA-&gt;DFA-&gt;最小DFA</h4>
<ol>
<li>先把正规式转换为 NFA（非确定有穷自动机）</li>
<li>再将 NFA 通过 &ldquo;子集构造法&rdquo; 转化为 DFA</li>
<li>最后将 DFA 通过 &ldquo;分割法&rdquo; 进行最小化</li>
</ol>
<h5 id="正规式转nfa">正规式转NFA</h5>
<p><figure 
	>
	<a href="https://pic.mcatk.com/soto/202112181329223.jpg" >
		<img src="https://pic.mcatk.com/soto/202112181329223.jpg"
			
			
			
			loading="lazy"
			alt="从正则生成NFA">
	</a>
	
	<figcaption>从正则生成NFA</figcaption>
	
</figure></p>
<p><figure 
	>
	<a href="https://pic.mcatk.com/soto/202112182248091.png" >
		<img src="https://pic.mcatk.com/soto/202112182248091.png"
			
			
			
			loading="lazy"
			alt="例">
	</a>
	
	<figcaption>例</figcaption>
	
</figure></p>
<h5 id="nfa确定化">NFA确定化</h5>
<ol>
<li>求初态<strong>闭包</strong>（能无条件滑动到的状态集合），作为第一个状态</li>
<li>将一个状态进行状态转移，求得到的状态的闭包的集合，作为新的状态</li>
</ol>
<p>反复以上2步，遍历，得到所有状态</p>
<h5 id="dfa最小化">DFA最小化</h5>
<ol>
<li>多余状态
<ol>
<li>本身不可达</li>
<li>不可到终态</li>
</ol>
</li>
<li>根据以下两个条件判断等价
<ol>
<li>一致性条件。根据终态和非终态划分</li>
<li>蔓延性条件。对于所有输入符号，状态s和状态t必须转换到等价的状态里。</li>
</ol>
</li>
</ol>
<p>步骤：</p>
<ol>
<li>分为<strong>终态和非终态</strong></li>
<li>考察两个集合，集合中任意两个状态通过状态转变后是否<strong>同在</strong>终态和非终态，不是则分</li>
</ol>
<h2 id="语法">语法</h2>
<h3 id="自顶向下">自顶向下</h3>
<h4 id="主要问题">主要问题</h4>
<ul>
<li>左递归
<ul>
<li>消除直接左递归</li>
<li>改右递归</li>
</ul>
</li>
<li>回溯
<ul>
<li>改写文法——提取</li>
<li>超前扫描</li>
</ul>
</li>
</ul>
<h4 id="递归子程序法">递归子程序法</h4>
<p>即递归下降分析法，拆解成多个子程序分析</p>
<h4 id="ll1分析法">LL(1)分析法</h4>
<p><strong>LL分析器</strong>是一种处理某些上下文无关文法自顶向下的分析器。因为它从<strong>左</strong>到右处理输入，再对句型执行<strong>最左推导</strong>出语法树</p>
<p>一个 LL 分析器若被称为 LL(k) 分析器，表示它使用 k 个词法单元作向前探查</p>
<p>求FIRST头符号和FOLLOW后继符号集</p>
<p>画出LL1分析表，每个非终结符通过哪一个产生式生成终结符。对于右部存在$\epsilon$的情况，则该产生式左部的FOLLOW集对应的终结符的位置都写上$\epsilon$</p>
<p>证明LL1文法：</p>
<ul>
<li>上表每格产生式最多为1</li>
<li>若无$\epsilon$，产生式右部FIRST集不相交（无共同头部）</li>
<li>若有$\epsilon$，产生式右部FIRST集和产生式左部FOLLOW集不相交</li>
</ul>
<p>分析过程：</p>
<p>符号栈｜读入符号｜剩余输入串｜所用产生式</p>
<h3 id="自底向上">自底向上</h3>
<h4 id="主要问题-1">主要问题</h4>
<p>句柄识别</p>
<h4 id="算符优先分析法">算符优先分析法</h4>
<p>在算符文法中，任何一个规则右部都不存在两个非终结符相邻的情况。如 AB</p>
<p>设有一个不含e规则的算符文法G，如果，任意两个终结符号对(a,b)在
＜、＞和=（优先级）种关系中只有一种关系成立，则称G是算符优先文法，也称OPG文法。</p>
<p>对于每个非终结符U（以下符号表示均不严谨，为个人理解）</p>
<p>FIRSTVT(U) = {b|U-&gt;b&hellip; or U-&gt;Vb&hellip;}</p>
<p>LASTVT(U) = {a|U-&gt;&hellip;a or U-&gt;&hellip;aV}</p>
<p>对于某规则右部：</p>
<ul>
<li>&hellip;aU&hellip; 对所有b$\in$FIRSTVT(U)有a$&lt;$b (优先级)</li>
<li>&hellip;Ub&hellip; 对所有a$\in$LASTVT(U) 有a$&gt;$b (优先级)</li>
</ul>
<p>通俗理解，若ab可以同时规约，则优先级相同，若b需要后续导出，则b优先级高，若a需要后续导出，则a优先级高，但注意序不可改变。</p>
<p>构造优先关系矩阵：</p>
<ol>
<li>为每个非终结符 A 计算 FIRSTVT(A) 和 LASTVT(A)</li>
<li>逐条扫描文法规则 例如+T 则 +&lt; FIRSTVT(T)，E+ 则 LASTVT(E)&gt;+</li>
<li>寻找#与开始符号E的关系 # = # ， # &lt;FIRSTVT(E)且LASTVT(E)&gt; #</li>
</ol>
<p>分析过程：</p>
<p>符号栈｜剩余输入串｜优先关系｜动作(移进/规约)</p>
<h4 id="lr分析法">LR分析法</h4>
<p>类似LL，R指分析过程是最右(Right)推导的逆过程(规范归约)</p>
<p>活前缀: 若分析过程能够保证栈中符号串均是规范句型 的前缀，则表示输入串已分析过的部分没有语 法错误，所以称为规范句型的活前缀。</p>
<p>对于句型αβt， β表示句柄,如果αβ= u1u2&hellip;ur 那么符号串u1u2&hellip;ui(1≤i≤r)即是句型αβt的活前缀</p>
<p>LR分析过程：</p>
<ol>
<li>拓广文法
<ol>
<li>头部E' -&gt; E</li>
<li>对形如A-&gt;B|C，拆解为A-&gt;B和A-&gt;C两条规则</li>
</ol>
</li>
<li>写出项目集规范族
<ol>
<li>从 E' -&gt; E 开始</li>
<li>求其<strong>闭包</strong>作为一个状态，“点”右移一位需要的符号作为<strong>状态转移符号</strong></li>
<li>反复求状态</li>
</ol>
</li>
<li>写出非终结符FIRST和<strong>FOLLOW</strong>集</li>
<li>画出GOTO和ACTION表
<ol>
<li>每个状态根据上一步骤得到的状态转移符号写上<strong>Sx</strong> 意为状态转移</li>
<li>若状态中的产生式“点”抵达结尾，则对于该产生式左部非终结符FOLLOW集中的终结符对应的格子写上<strong>rx</strong>，意为按某产生式<strong>规约</strong></li>
</ol>
</li>
</ol>
<p>分析过程：</p>
<p>状态栈｜符号｜输入串｜动作(S/rx)</p>
<h2 id="语法制导">语法制导</h2>
<h3 id="翻译文法">翻译文法</h3>
<ul>
<li>插入动作符号的文法。</li>
<li>翻译文法是<strong>上下文无关文法</strong>（2型文法）。</li>
<li>终结符号集由<strong>输入符号</strong>和<strong>动作符号</strong>组成。</li>
<li>由<strong>翻译文法</strong>可以通过推导产生<strong>活动序列</strong>。由翻译文法所产生的<strong>终结符号串</strong>称为<strong>活动序列</strong>。</li>
</ul>
<p>动作序列：带着@推导得到的序列</p>
<p>输出序列：每个@后的字符的序列</p>
<h3 id="属性翻译文法">属性翻译文法</h3>
<p>↓继承属性 ↑综合属性</p>
<p>L-ATG 转换为 SL-ATG</p>
<p>考虑产生式：</p>
<p>&lt; A &gt; → a↑R &lt; B &gt;↑S &lt; C &gt;↓I，I := f(R , S)</p>
<p>设动作符号“@ f ” 表示函数 f 求值，该动作符号有两个继承属性和一个综合属性。</p>
<p>@f↓I1,I2↑S1  S1 := f(I1, I2)</p>
<p>修改产生式</p>
<p>插入“@ f ” 到右部的适当位置，引进新的复写规则（将R，S 赋给 I1 和 I2，f 值赋给 S1），删去原有包含 f 的规则
&lt; A &gt; → a↑R &lt; B &gt;↑S @ f↓I1,I2↑S1 &lt; C &gt;↓I，I1 := R，I2 := S，S1 := f( I1, I2)，I := S1</p>
<p>该文法是简单赋值形式的L-ATG。</p>
<h2 id="动态存储分配">动态存储分配</h2>
<h3 id="活动记录">活动记录</h3>
<p>AR(Activation Record )：当进入一个程序模块时，在运行栈内创建的专用数据区</p>
<table>
<thead>
<tr>
<th>活动记录</th>
</tr>
</thead>
<tbody>
<tr>
<td>参数区域</td>
</tr>
<tr>
<td>display区</td>
</tr>
<tr>
<td>局部数据区</td>
</tr>
</tbody>
</table>
<ul>
<li>局部数据区</li>
<li>参数区域
<ul>
<li>隐式参数
<ul>
<li>一个返回地址</li>
<li>一个指向前一个AR的指针prevabp</li>
<li>一个返回值</li>
</ul>
</li>
<li>显式参数</li>
</ul>
</li>
<li>display区
<ul>
<li>全局指向其他活动记录的指针</li>
</ul>
</li>
</ul>
<h2 id="代码优化">代码优化</h2>
<h3 id="基本块内优化">基本块内优化</h3>
<p>基本块：只能从入口进入出口离开，根据跳转划分</p>
<h4 id="dag图">DAG图</h4>
<p>画出DAG图，重新导出代码序列</p>
<p>其中，没有初始化的变量可以用下标0来标注</p>
<h5 id="通过构建dag图消除公共子表达式">通过构建DAG图消除公共子表达式</h5>
<ol>
<li>初始化一个节点表</li>
<li>从第一条指令开始
<ol>
<li>若为 z=x op y，若不存在节点x和y，则<strong>创建节点x和y</strong>，在<strong>节点表</strong>标注x和y的节点序号。根据op创建新的节点作为前两个节点的<strong>父节点</strong>，<strong>节点表</strong>给z标注该节点序号。注意新的标注要覆盖原来的。</li>
<li>若为z=x则直接让给z标注为x的节点。</li>
</ol>
</li>
<li>重复，遍历指令</li>
</ol>
<p><figure 
	>
	<a href="https://pic.mcatk.com/soto/202112192012979.png" >
		<img src="https://pic.mcatk.com/soto/202112192012979.png"
			
			
			
			loading="lazy"
			alt="示例">
	</a>
	
	<figcaption>示例</figcaption>
	
</figure></p>
<h5 id="从dag图导出中间代码的启发式算法">从DAG图导出中间代码的启发式算法</h5>
<ol>
<li>初始化一个队列</li>
<li>找到一个<strong>父节点</strong>不在队列或者没有父节点的节点，加入队列</li>
<li>查看该节点的<strong>最左子节点</strong>，若父节点都在队列，则加入队列，然后查看最左子节点的子节点，若不满足条件，重新做2</li>
<li>重复，遍历所有节点</li>
<li><strong>逆序</strong>输出，则得到中间节点的计算顺序，写出新的代码序列</li>
</ol>
<p><figure 
	>
	<a href="https://pic.mcatk.com/soto/202112192012200.png" >
		<img src="https://pic.mcatk.com/soto/202112192012200.png"
			
			
			
			loading="lazy"
			alt="上述示例的结果">
	</a>
	
	<figcaption>上述示例的结果</figcaption>
	
</figure></p>
<h4 id="窥孔优化">窥孔优化</h4>
<p>删除一小段内的冗余指令</p>
<h3 id="全局优化">全局优化</h3>
<h4 id="数据流分析">数据流分析</h4>
<h5 id="到达定义数据流分析">到达定义数据流分析</h5>
<p>强调一条语句</p>
<ol>
<li>写出每个基本块的gen和kill</li>
<li>根据下述公式计算每个基本块的out，其中in为前驱的out</li>
</ol>
<p>$$out[B] = gen[B]\cup(in[B]-kill[B])$$</p>
<ol start="3">
<li>反复操作，直到out不再变</li>
</ol>
<ul>
<li>gen：块中定义变量的语句</li>
<li>kill：消灭（给其重新赋值）了其他块中定义变量的语句</li>
</ul>
<h5 id="活跃变量分析">活跃变量分析</h5>
<p>强调变量本身</p>
<ol>
<li>写出每个基本块的def和use</li>
<li>根据下述公式计算每个基本块的in，其中out为后驱的in</li>
</ol>
<p>$$in[B] = use[B]\cup(out[B]-def[B])$$</p>
<ol start="3">
<li>反复操作，直到in不再变</li>
</ol>
<ul>
<li>def：定义先于使用的变量</li>
<li>use：使用先于定义的变量</li>
</ul>
<p>对于在多个基本块之间传递，持续活跃的，可以作出变量冲突图</p>
<p>若一个变量在另一个变量活跃处定义则冲突</p>
<h3 id="寄存器分配">寄存器分配</h3>
<h4 id="引用计数">引用计数</h4>
<p>根据变量的引用次数排序分配寄存器，给在循环中的变量加上一个与层数有关的权值。</p>
<h4 id="图着色算法">图着色算法</h4>
<h5 id="构建冲突图">构建冲突图</h5>
<p>参考活跃变量分析</p>
<h5 id="图着色算法-1">图着色算法</h5>
<p>寄存器数量K，对应K个颜色</p>
<ol>
<li>取出1个边小于K的节点，移走，记录，重复，直到剩1个。若无法移，任选一个点作为无法着色点移除再重新操作。</li>
<li>按照刚才移走的逆序为节点着色，相邻节点不能为同一颜色。</li>
</ol>

</section>


    <footer class="article-footer">
    
    <section class="article-tags">
        
            <a href="/tags/%E7%BC%96%E8%AF%91/">编译</a>
        
    </section>


    
    <section class="article-copyright">
        <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-copyright" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="12" cy="12" r="9" />
  <path d="M14.5 9a3.5 4 0 1 0 0 6" />
</svg>



        <span>Licensed under CC BY-NC-SA 4.0</span>
    </section>
    </footer>


    
        <link 
                rel="stylesheet" 
                href="https://cdn.jsdelivr.net/npm/katex@0.13.13/dist/katex.min.css"integrity="sha384-RZU/ijkSsFbcmivfdRBQDtwuwVqK7GMOw6IMvKyeWL2K5UAlyp6WonmB8m7Jd0Hn"crossorigin="anonymous"
            ><script 
                src="https://cdn.jsdelivr.net/npm/katex@0.13.13/dist/katex.min.js"integrity="sha384-pK1WpvzWVBQiP0/GjnvRxV4mOb0oxFuyRxJlk6vVw146n3egcN5C925NCP7a7BY8"crossorigin="anonymous"
                defer="true"
                >
            </script><script 
                src="https://cdn.jsdelivr.net/npm/katex@0.13.13/dist/contrib/auto-render.min.js"integrity="sha384-vZTG03m&#43;2yp6N6BNi5iM4rW4oIwk5DfcNdFfxkk9ZWpDriOkXX8voJBFrAO7MpVl"crossorigin="anonymous"
                defer="true"
                >
            </script><script>
    window.addEventListener("DOMContentLoaded", () => {
        renderMathInElement(document.querySelector(`.article-content`), {
            delimiters: [
                { left: "$$", right: "$$", display: true },
                { left: "$", right: "$", display: false },
                { left: "\\(", right: "\\)", display: false },
                { left: "\\[", right: "\\]", display: true }
            ]
        });})
</script>
    
</article>

    <aside class="related-contents--wrapper">
    
    
        <h2 class="section-title">相关文章</h2>
        <div class="related-contents">
            <div class="flex article-list--tile">
                
                    
<article class="has-image">
    <a href="/p/alxa_compiler-%E7%BC%96%E8%AF%91%E5%99%A8/">
        
        
            <div class="article-image">
                
                    <img src="https://tva1.sinaimg.cn/large/008i3skNly1gwuyxmimj1j30tg0c0wfl.jpg" loading="lazy" data-key="" data-hash="https://tva1.sinaimg.cn/large/008i3skNly1gwuyxmimj1j30tg0c0wfl.jpg"/>
                
            </div>
        

        <div class="article-details">
            <h2 class="article-title">Alxa_Compiler 编译器</h2>
        </div>
    </a>
</article>
                
                    
<article class="has-image">
    <a href="/p/takeawaydelivery-back/">
        
        
            <div class="article-image">
                
                    <img src="https://pic.mcatk.com/soto/202112170131240.png" loading="lazy" data-key="TakeawayDelivery-back" data-hash="https://pic.mcatk.com/soto/202112170131240.png"/>
                
            </div>
        

        <div class="article-details">
            <h2 class="article-title">TakeawayDelivery 后端实现</h2>
        </div>
    </a>
</article>
                
                    
<article class="">
    <a href="/p/macos%E5%85%A8%E5%B1%80%E5%8F%AF%E6%89%A7%E8%A1%8C%E6%96%87%E4%BB%B6/">
        
        

        <div class="article-details">
            <h2 class="article-title">MacOS全局可执行文件</h2>
        </div>
    </a>
</article>
                
                    
<article class="has-image">
    <a href="/p/iotmonitor/">
        
        
            <div class="article-image">
                
                    <img src="https://tva1.sinaimg.cn/large/008i3skNly1gwuaqehi6ej30lg0eggmc.jpg" loading="lazy" data-key="" data-hash="https://tva1.sinaimg.cn/large/008i3skNly1gwuaqehi6ej30lg0eggmc.jpg"/>
                
            </div>
        

        <div class="article-details">
            <h2 class="article-title">IoTMonitor</h2>
        </div>
    </a>
</article>
                
                    
<article class="has-image">
    <a href="/p/memo%E6%96%87%E6%A1%A3/">
        
        
            <div class="article-image">
                
                    <img src="https://tva1.sinaimg.cn/large/008i3skNly1gwv08ty64aj31340m4761.jpg" loading="lazy" data-key="" data-hash="https://tva1.sinaimg.cn/large/008i3skNly1gwv08ty64aj31340m4761.jpg"/>
                
            </div>
        

        <div class="article-details">
            <h2 class="article-title">Memo文档</h2>
        </div>
    </a>
</article>
                
            </div>
        </div>
    
</aside>

     
    
        
    

    <section class="a">
    
</section>

    
<div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">

    
    <div class="pswp__bg"></div>

    
    <div class="pswp__scroll-wrap">

        
        <div class="pswp__container">
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
        </div>

        
        <div class="pswp__ui pswp__ui--hidden">

            <div class="pswp__top-bar">

                

                <div class="pswp__counter"></div>

                <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>

                <button class="pswp__button pswp__button--share" title="Share"></button>

                <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>

                <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>

                
                
                <div class="pswp__preloader">
                    <div class="pswp__preloader__icn">
                        <div class="pswp__preloader__cut">
                            <div class="pswp__preloader__donut"></div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
                <div class="pswp__share-tooltip"></div>
            </div>

            <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
            </button>

            <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
            </button>

            <div class="pswp__caption">
                <div class="pswp__caption__center"></div>
            </div>

        </div>

    </div>

</div><script 
                src="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.js"integrity="sha256-ePwmChbbvXbsO02lbM3HoHbSHTHFAeChekF1xKJdleo="crossorigin="anonymous"
                defer="true"
                >
            </script><script 
                src="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe-ui-default.min.js"integrity="sha256-UKkzOn/w1mBxRmLLGrSeyB4e1xbrp4xylgAWb3M42pU="crossorigin="anonymous"
                defer="true"
                >
            </script><link 
                rel="stylesheet" 
                href="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/default-skin/default-skin.css"integrity="sha256-c0uckgykQ9v5k&#43;IqViZOZKc47Jn7KQil4/MP3ySA3F8="crossorigin="anonymous"
            ><link 
                rel="stylesheet" 
                href="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.css"integrity="sha256-SBLU4vv6CA6lHsZ1XyTdhyjJxCjPif/TRkjnsyGAGnE="crossorigin="anonymous"
            >

            </main>
    
        <aside class="sidebar right-sidebar sticky">
            <section class="widget archives">
                <div class="widget-icon">
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-hash" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <line x1="5" y1="9" x2="19" y2="9" />
  <line x1="5" y1="15" x2="19" y2="15" />
  <line x1="11" y1="4" x2="7" y2="20" />
  <line x1="17" y1="4" x2="13" y2="20" />
</svg>



                </div>
                <h2 class="widget-title section-title">目录</h2>
                
                <div class="widget--toc">
                    <nav id="TableOfContents">
  <ol>
    <li><a href="#编译过程">编译过程</a></li>
    <li><a href="#文法">文法</a>
      <ol>
        <li><a href="#推导">推导</a></li>
        <li><a href="#句型-短语-句柄">句型 短语 句柄</a>
          <ol>
            <li><a href="#一个例子">一个例子</a></li>
          </ol>
        </li>
        <li><a href="#chomsky文法体系">Chomsky文法体系</a></li>
        <li><a href="#二义性">二义性</a></li>
        <li><a href="#文法的实用限制">文法的实用限制</a></li>
      </ol>
    </li>
    <li><a href="#词法">词法</a>
      <ol>
        <li><a href="#正则文法和状态图">正则文法和状态图</a></li>
        <li><a href="#正则表达式与有穷自动机">正则表达式与有穷自动机</a>
          <ol>
            <li><a href="#dfa">DFA</a></li>
            <li><a href="#nfa">NFA</a></li>
            <li><a href="#nfa-dfa-最小dfa">NFA-&gt;DFA-&gt;最小DFA</a></li>
          </ol>
        </li>
      </ol>
    </li>
    <li><a href="#语法">语法</a>
      <ol>
        <li><a href="#自顶向下">自顶向下</a>
          <ol>
            <li><a href="#主要问题">主要问题</a></li>
            <li><a href="#递归子程序法">递归子程序法</a></li>
            <li><a href="#ll1分析法">LL(1)分析法</a></li>
          </ol>
        </li>
        <li><a href="#自底向上">自底向上</a>
          <ol>
            <li><a href="#主要问题-1">主要问题</a></li>
            <li><a href="#算符优先分析法">算符优先分析法</a></li>
            <li><a href="#lr分析法">LR分析法</a></li>
          </ol>
        </li>
      </ol>
    </li>
    <li><a href="#语法制导">语法制导</a>
      <ol>
        <li><a href="#翻译文法">翻译文法</a></li>
        <li><a href="#属性翻译文法">属性翻译文法</a></li>
      </ol>
    </li>
    <li><a href="#动态存储分配">动态存储分配</a>
      <ol>
        <li><a href="#活动记录">活动记录</a></li>
      </ol>
    </li>
    <li><a href="#代码优化">代码优化</a>
      <ol>
        <li><a href="#基本块内优化">基本块内优化</a>
          <ol>
            <li><a href="#dag图">DAG图</a></li>
            <li><a href="#窥孔优化">窥孔优化</a></li>
          </ol>
        </li>
        <li><a href="#全局优化">全局优化</a>
          <ol>
            <li><a href="#数据流分析">数据流分析</a></li>
          </ol>
        </li>
        <li><a href="#寄存器分配">寄存器分配</a>
          <ol>
            <li><a href="#引用计数">引用计数</a></li>
            <li><a href="#图着色算法">图着色算法</a></li>
          </ol>
        </li>
      </ol>
    </li>
  </ol>
</nav>
                </div>
            </section>
        </aside>
    

        </div>
        <script 
                src="https://cdn.jsdelivr.net/npm/node-vibrant@3.1.5/dist/vibrant.min.js"integrity="sha256-5NovOZc4iwiAWTYIFiIM7DxKUXKWvpVEuMEPLzcm5/g="crossorigin="anonymous"
                defer="false"
                >
            </script><script type="text/javascript" src="/ts/main.js" defer></script>
<script>
    (function () {
        const customFont = document.createElement('link');
        customFont.href = "https://fonts.googleapis.com/css2?family=Lato:wght@300;400;700&display=swap";

        customFont.type = "text/css";
        customFont.rel = "stylesheet";

        document.head.appendChild(customFont);
    }());
</script>

    </body>
</html>
